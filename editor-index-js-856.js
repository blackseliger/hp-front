(self.webpackChunkhp_front=self.webpackChunkhp_front||[]).push([[856],{234:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>d});var n=s(381),a=s.n(n);const i=[{id:"name",title:"Name",template:e=>`<div class="table__content-cell table__content-cell_accordion">\n    <div class="table__icon-accordion">\n    <svg class="table__icon-img" data-element="handleOpen" width="18" height="10" viewBox="0 0 18 10" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n<path  clip-rule="evenodd" d="M0.292893 0.292893C0.683417 -0.0976311 1.31658 -0.0976311 1.70711 0.292893L9 7.58579L16.2929 0.292893C16.6834 -0.0976311 17.3166 -0.0976311 17.7071 0.292893C18.0976 0.683417 18.0976 1.31658 17.7071 1.70711L9.70711 9.70711C9.31658 10.0976 8.68342 10.0976 8.29289 9.70711L0.292893 1.70711C-0.0976311 1.31658 -0.0976311 0.683417 0.292893 0.292893Z" />\n</svg>\n\n    </div>    \n    <div data-row='name'>${e}</div>\n</div>`},{id:"created",title:"date",template:e=>`<div class="table__content-cell" data-element="${e}">${a()(e).format("DD:MM:YYYY h:mm")}</div>`},{id:"action",title:"Action",template:()=>'<div class="table__content-cell table__content-cell-icons">\n    <div class="table__icon">\n        <img src="./assets/icons/handleEdit.svg" class="table__icon-img" data-element="handleEdit" alt="edit">\n    </div>\n    <div class="table__icon">\n        <img src="./assets/icons/handleDelete.svg" class="table__icon-img" data-element="handleDelete" alt="delete">\n    </div>\n</div>'}];function r(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}const l="https://hp34.herokuapp.com/";class o{async deleteFetch(e){const t=new URL("tickets",l);t.searchParams.set("id",e);try{return await fetch(t,{method:"DELETE"})}catch(e){console.log(e.message)}}async putFetch(e,t){const s=new URL("tickets",l);s.searchParams.set("id",e);try{const e=await fetch(s,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return await e.json()}catch(e){return await e.message}}async fetchPost(e){const t=new URL("tickets",l);try{const s=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});return await s.json()}catch(e){return e.message}}async removeElement(e){const t=e.target.closest(".table__content-row").dataset.id;(await this.deleteFetch(t)).ok&&(this.data=[...this.data].filter(e=>e.id!==t),e.target.closest(".table__content-row").remove())}constructor(){r(this,"subElements",{}),r(this,"wrapper",null),r(this,"onClick",async e=>{const t=e.target.closest("[data-element=handleDelete]"),s=e.target.closest("[data-element=handleEdit]"),n=e.target.closest("[data-element=handleOpen]");if(s&&this.editElement(e),t&&await this.removeElement(e),n){n.closest(".table__content-row").lastElementChild.classList.toggle("table__detailed_hide")}}),r(this,"onEdit",async e=>{e.preventDefault();const{productForm:t,tableContent:s}=this.subElements,n=Object.keys(this.defaultForm),a={},i=e=>t.querySelector(`[name=${e}]`).value;for(const e of n)a[e]=i(e);const r=await this.putFetch(this.id,a),l=s.querySelector(`[data-element='${this.id}']`),o=e=>l.querySelector(`[data-row='${e}']`),c=["name","description"];for(const e of c)o(e).textContent=r[e];this.deleteForm()}),r(this,"onForm",e=>{if(e.target.closest("[data-element=handleAdd]")){if(null!==this.wrapper)return;this.createForm();const{productForm:e}=this.subElements;e.addEventListener("submit",this.onSave),e.addEventListener("click",this.hideForm)}}),r(this,"hideForm",e=>{e.target.closest("[data-element=hideForm]")&&(this.subElements.productForm.remove(),this.wrapper=null)}),r(this,"onSave",async e=>{e.preventDefault();const t=Object.keys(this.defaultForm),{productForm:s,tableContent:n}=this.subElements,a=e=>s.querySelector(`[name=${e}]`).value,i={};for(const e of t)i[e]=a(e);const r=await this.fetchPost(i),l=document.createElement("div");l.innerHTML=this.getTableRows(r),n.append(l),this.deleteForm()}),this.headerConfig=i,this.render(),this.defaultForm={name:"",description:0},this.id=null}async render(){const e=document.createElement("div");e.innerHTML=this.getTemplate(),this.element=e.firstElementChild,this.subElements=this.getSubElements();const t=await this.loadData();this.renderRows(t),this.initEventListeners()}async loadData(){const e=new URL("tickets",l),t=await fetch(e);return await t.json()}renderRows(e){e.length&&this.addRows(e)}addRows(e){this.data=e,this.subElements.tableContent.innerHTML=this.getTableRows(e)}initEventListeners(){const{tableContent:e,tableHeader:t}=this.subElements;e.addEventListener("click",this.onClick),t.addEventListener("click",this.onForm)}removeEventListeners(){document.removeEventListener("click",this.onClick),document.removeEventListener("click",this.onForm),document.removeEventListener("submit",this.onEdit)}createForm(e){this.wrapper=document.createElement("div"),this.wrapper.innerHTML=this.getFormGroup(e),this.element.append(this.wrapper.firstElementChild),this.subElements.productForm=this.element.querySelector("[data-element=productForm")}setFormData(e){const{productForm:t}=this.subElements,s=Object.keys(this.defaultForm);for(const n of s){const s=t.querySelector(`[name="${n}"]`);null!==s&&(s.value=e[n]||this.defaultForm[n])}t.addEventListener("click",this.hideForm),t.addEventListener("submit",this.onEdit)}editElement(e){if(null!==this.wrapper)return;this.id=e.target.closest(".table__content-row").dataset.id;const t=this.data.find(e=>e.id===this.id);this.createForm("edit"),this.setFormData(t)}getSubElements(){const e=this.element.querySelectorAll("[data-element]");for(const t of e)this.subElements[t.dataset.element]=t;return this.subElements}getTableRows(e){if(!Array.isArray(e)){const t=[];t.push(e),e=t}return e.map(e=>`\n        <div class="table__content-body-row table__content-row" data-element="${e.id}" data-id="${e.id}">\n        <div class="table__content-brief"> ${this.getTableRow(e)}</div>\n        <div class="table__detailed table__detailed_hide"><p data-row='description'>${e.description}</p></div>\n        </div>\n        `).join("")}getTableRow(e){return this.headerConfig.map(e=>{let{id:t,template:s}=e;return{id:t,template:s}}).map(t=>{let{id:s,template:n}=t;return n?n(e[s]):` <div class="table__content-cell" data-element="${s}">${e[s]}</div>`}).join("")}getFormGroup(e){return`<form class="form-group" data-element="productForm">\n        <div class="form-group_icon">\n                <img src="./assets/icons/handleDelete.svg" data-element="hideForm" alt="">\n            </div>\n        <div class="from-group__title">${e?"Изменить тикет":"Добавить тикет"}</div>\n        <label for="name" class="form-group__label">Название</label>\n        <div class="form-group__input">\n            <input class="form-group__control" name="name" type="text" id="name" required placeholder="Название задачи">\n        </div>\n        <label for="price" class="form-group__label">Описание</label>\n        <div class="form-group__input">\n            <input class="form-group__control" name="description" type="text" id="description" required placeholder="Подробное описание">\n        </div>\n        <div class="form-group__buttons">\n            <button  name="save" class="button button_primary">\n                Save\n             </button>\n             <input  name="reset" class="button button_primary" type="reset" value="Reset">\n        </div>\n    </form>`}getTemplate(){return'\n            <div class="container" data-element="tableEdit">\n                <div class="table__header" data-element="tableHeader">\n                <button  class="button button_primary table__button" data-element="handleAdd">\n                Добавить тикет\n             </button>\n                </div>\n                <div class="table__content" data-element="tableContent">\n                 \n                </div>\n            </div>'}deleteForm(){const{productForm:e}=this.subElements;e.remove(),document.removeEventListener("click",this.hideForm),document.removeEventListener("submit",this.onSave),this.wrapper=null,this.subElements.productForm=null,this.id=null}remove(){this.element&&this.element.remove()}destroy(){this.remove(),this.element=null,this.subElements=null}}function c(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}class d{constructor(){c(this,"subElements",{}),c(this,"components",{})}render(){const e=document.createElement("div");return e.innerHTML=this.getTemplate(),this.element=e.firstElementChild,this.subElements=this.getSubElements(),this.initComponents(),this.renderComponents(),this.element}initComponents(){const e=new o;this.components={table:e}}renderComponents(){Object.keys(this.components).forEach(e=>{console.log(e);const t=this.subElements[e],{element:s}=this.components[e];t.append(s)})}getSubElements(){const e=this.element.querySelectorAll("[data-element]");for(const t of e)this.subElements[t.dataset.element]=t;return this.subElements}removeEventListeners(){this.removeEventListeners()}remove(){this.element&&this.element.remove()}destroy(){this.remove(),this.element=null,this.subElements=null;for(const e of Object.values(this.components))e.destroy()}getTemplate(){return'\n        <div>\n        <div class="table" data-element="table">\n\n        </div>\n        </div>\n        '}}},6700:(e,t,s)=>{var n={"./af":2786,"./af.js":2786,"./ar":867,"./ar-dz":4130,"./ar-dz.js":4130,"./ar-kw":6135,"./ar-kw.js":6135,"./ar-ly":6440,"./ar-ly.js":6440,"./ar-ma":7702,"./ar-ma.js":7702,"./ar-sa":6040,"./ar-sa.js":6040,"./ar-tn":7100,"./ar-tn.js":7100,"./ar.js":867,"./az":1083,"./az.js":1083,"./be":9808,"./be.js":9808,"./bg":8338,"./bg.js":8338,"./bm":7438,"./bm.js":7438,"./bn":8905,"./bn-bd":6225,"./bn-bd.js":6225,"./bn.js":8905,"./bo":1560,"./bo.js":1560,"./br":1278,"./br.js":1278,"./bs":622,"./bs.js":622,"./ca":2468,"./ca.js":2468,"./cs":5822,"./cs.js":5822,"./cv":877,"./cv.js":877,"./cy":7373,"./cy.js":7373,"./da":4780,"./da.js":4780,"./de":9740,"./de-at":217,"./de-at.js":217,"./de-ch":894,"./de-ch.js":894,"./de.js":9740,"./dv":5300,"./dv.js":5300,"./el":837,"./el.js":837,"./en-au":8348,"./en-au.js":8348,"./en-ca":7925,"./en-ca.js":7925,"./en-gb":2243,"./en-gb.js":2243,"./en-ie":6436,"./en-ie.js":6436,"./en-il":7207,"./en-il.js":7207,"./en-in":4175,"./en-in.js":4175,"./en-nz":6319,"./en-nz.js":6319,"./en-sg":1662,"./en-sg.js":1662,"./eo":2915,"./eo.js":2915,"./es":5655,"./es-do":5251,"./es-do.js":5251,"./es-mx":6112,"./es-mx.js":6112,"./es-us":1146,"./es-us.js":1146,"./es.js":5655,"./et":5603,"./et.js":5603,"./eu":7763,"./eu.js":7763,"./fa":6959,"./fa.js":6959,"./fi":1897,"./fi.js":1897,"./fil":2549,"./fil.js":2549,"./fo":4694,"./fo.js":4694,"./fr":4470,"./fr-ca":3049,"./fr-ca.js":3049,"./fr-ch":2330,"./fr-ch.js":2330,"./fr.js":4470,"./fy":5044,"./fy.js":5044,"./ga":9295,"./ga.js":9295,"./gd":2101,"./gd.js":2101,"./gl":8794,"./gl.js":8794,"./gom-deva":7884,"./gom-deva.js":7884,"./gom-latn":3168,"./gom-latn.js":3168,"./gu":5349,"./gu.js":5349,"./he":4206,"./he.js":4206,"./hi":94,"./hi.js":94,"./hr":316,"./hr.js":316,"./hu":2138,"./hu.js":2138,"./hy-am":1423,"./hy-am.js":1423,"./id":9218,"./id.js":9218,"./is":135,"./is.js":135,"./it":626,"./it-ch":150,"./it-ch.js":150,"./it.js":626,"./ja":9183,"./ja.js":9183,"./jv":4286,"./jv.js":4286,"./ka":2105,"./ka.js":2105,"./kk":7772,"./kk.js":7772,"./km":8758,"./km.js":8758,"./kn":9282,"./kn.js":9282,"./ko":3730,"./ko.js":3730,"./ku":1408,"./ku.js":1408,"./ky":3291,"./ky.js":3291,"./lb":6841,"./lb.js":6841,"./lo":5466,"./lo.js":5466,"./lt":7010,"./lt.js":7010,"./lv":7595,"./lv.js":7595,"./me":9861,"./me.js":9861,"./mi":5493,"./mi.js":5493,"./mk":5966,"./mk.js":5966,"./ml":7341,"./ml.js":7341,"./mn":5115,"./mn.js":5115,"./mr":370,"./mr.js":370,"./ms":9847,"./ms-my":1237,"./ms-my.js":1237,"./ms.js":9847,"./mt":2126,"./mt.js":2126,"./my":6165,"./my.js":6165,"./nb":4924,"./nb.js":4924,"./ne":6744,"./ne.js":6744,"./nl":3901,"./nl-be":9814,"./nl-be.js":9814,"./nl.js":3901,"./nn":3877,"./nn.js":3877,"./oc-lnc":2135,"./oc-lnc.js":2135,"./pa-in":5858,"./pa-in.js":5858,"./pl":4495,"./pl.js":4495,"./pt":9520,"./pt-br":7971,"./pt-br.js":7971,"./pt.js":9520,"./ro":6459,"./ro.js":6459,"./ru":1793,"./ru.js":1793,"./sd":950,"./sd.js":950,"./se":490,"./se.js":490,"./si":124,"./si.js":124,"./sk":4249,"./sk.js":4249,"./sl":4985,"./sl.js":4985,"./sq":1104,"./sq.js":1104,"./sr":9131,"./sr-cyrl":9915,"./sr-cyrl.js":9915,"./sr.js":9131,"./ss":5893,"./ss.js":5893,"./sv":8760,"./sv.js":8760,"./sw":1172,"./sw.js":1172,"./ta":7333,"./ta.js":7333,"./te":3110,"./te.js":3110,"./tet":2095,"./tet.js":2095,"./tg":7321,"./tg.js":7321,"./th":9041,"./th.js":9041,"./tk":9005,"./tk.js":9005,"./tl-ph":5768,"./tl-ph.js":5768,"./tlh":9444,"./tlh.js":9444,"./tr":2397,"./tr.js":2397,"./tzl":8254,"./tzl.js":8254,"./tzm":1106,"./tzm-latn":699,"./tzm-latn.js":699,"./tzm.js":1106,"./ug-cn":9288,"./ug-cn.js":9288,"./uk":7691,"./uk.js":7691,"./ur":3795,"./ur.js":3795,"./uz":6791,"./uz-latn":588,"./uz-latn.js":588,"./uz.js":6791,"./vi":5666,"./vi.js":5666,"./x-pseudo":4378,"./x-pseudo.js":4378,"./yo":5805,"./yo.js":5805,"./zh-cn":3839,"./zh-cn.js":3839,"./zh-hk":5726,"./zh-hk.js":5726,"./zh-mo":9807,"./zh-mo.js":9807,"./zh-tw":4152,"./zh-tw.js":4152};function a(e){var t=i(e);return s(t)}function i(e){if(!s.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}a.keys=function(){return Object.keys(n)},a.resolve=i,e.exports=a,a.id=6700}}]);
//# sourceMappingURL=editor-index-js-856.js.map